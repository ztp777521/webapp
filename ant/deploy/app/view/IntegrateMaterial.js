Ext.define("eapp.view.IntegrateMaterial",{extend:"Ext.List",xtype:"integrate_materialview",alternateClassName:"eapp.integrate_material",config:{title:"新闻咨询",store:null,pageno:"1",totalpages:"0",scrollable:{direction:"vertical",directionLock:true},items:[{xtype:"container",id:"newsid",style:"font-size: 25px;  text-align: center;",html:"",},],itemTpl:["<table>","	<tr>",'		<td rowspan="2"><tpl if="image == \'\'"><img style=" width:50px; height:50px;" src="images/newstu.png"/><tpl else><img style=" width:50px; height:50px;" src="{image}" /></tpl></td>','		<td><div style="margin-left: 5px;width: 235px;" class="textoneline">{titles}</div></td>',"	</tr>","	<tr>",'		<td><div style="margin-left: 5px;width: 235px;font-size: 12px;color: #aaa;" >{summarys}</div></td>',"	</tr>","</table>"],},init:function(){var b=this;Ext.Viewport.setMasked({xtype:"loadmask",message:"请稍候..."});var a=eapp.app.appData.eApp.get("appid");var c=Ext.create("eapp.business.NewsService");c.getNewsList(b.getPageno(),10,a,2801,{success:function(g){console.log(g);for(var f=0;f<g.result.length;f++){var h=g.result[f].title;var e=g.result[f].summary;if(h.length>12){h=h.substring(0,12)+"..."}g.result[f].titles=h;if(e.length>37){e=e.substring(0,37)+"..."}g.result[f].summarys=e}var d=b.getStore();if(d==null||d=="undefined"){d=Ext.create("eapp.store.EAppNews",{data:g.result})}else{d.add(g.result)}b.setStore(d);b.setPageno(g.pageno);b.setTotalpages(g.totalpages);if(g.result.length==0){Ext.ComponentQuery.query("#newsid",b)[0].setHtml("暂无新闻")}Ext.Viewport.setMasked(false)},failure:function(d){console.log(d);Ext.Viewport.setMasked(false)}})},initialize:function(){this.callParent(arguments);var a=this;var b=0;a.getScrollable().getScroller().on("scrollend",function(d,c,f,e){if((b-f)==0&&(Number)(a.getTotalpages())!=(Number)(a.getPageno())){console.log(a.getTotalpages());if(a.getTotalpages()==1){return}else{a.setPageno((Number)(a.getPageno())+1);a.init()}}});this.getScrollable().getScroller().on("maxpositionchange",function(c,e,d){b=e.y})},});