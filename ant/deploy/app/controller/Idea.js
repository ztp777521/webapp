Ext.define("eapp.controller.Idea",{extend:"Ext.app.Controller",config:{refs:{mainview:"mainview",ideaView:"ideaView",ideapageview:"ideapageview",idealistview:"idealistview",ideasubmitname:{selector:"ideaView formpanel button[name=ideasubmitname]"},suggestionpage:{selector:"ideapageview formpanel fieldset labelEx[name=suggestionpage]"},aboutuspage:{selector:"ideapageview formpanel fieldset labelEx[name=aboutuspage]"},},control:{ideasubmitname:{tap:"OnIdeasubmitnameTap",},suggestionpage:{tap:"OnSuggestionpageTap"},aboutuspage:{tap:"OnAboutuspageTap",}}},OnAboutuspageTap:function(){var c=this;var d=c.getIdeaView();if(d==null||d=="undefined"){d=Ext.create("eapp.view.zhihuiyanlu.Idea")}var b=eapp.util.GlobalData.getCurrentUser();Ext.ComponentQuery.query("#ideausernameid",d)[0].setValue(b.get("realname"));c.getMainview().push(d);var a=eapp.app.pageStack.length;if(eapp.app.pageStack[a-1]!="ideaview"){eapp.app.pageStack.push("ideaview")}},OnSuggestionpageTap:function(){var c=this;var b=c.getIdealistview();if(b==null||b=="undefined"){b=Ext.create("eapp.view.zhihuiyanlu.IdeaList")}b.init();c.getMainview().push(b);var a=eapp.app.pageStack.length;if(eapp.app.pageStack[a-1]!="idealistview"){eapp.app.pageStack.push("idealistview")}},OnIdeasubmitnameTap:function(){var f=this;var h=f.getIdeaView();if(h==null||h=="undefined"){h=Ext.create("eapp.view.zhihuiyanlu.Idea")}var c=eapp.util.GlobalData.getCurrentUser();var d=c.get("userid");var g=c.get("realname");var a=Ext.ComponentQuery.query("#ideaphoneid",h)[0].getValue();var e=Ext.ComponentQuery.query("#ideaemailid",h)[0].getValue();var i=Ext.ComponentQuery.query("#remarkContent",h)[0].getValue();if(g==null||g=="undefined"||g.length<=0){eapp.view.Dialogs.showAlert("智慧潘家园","用户名称不能为空!~")}if(g==null||g=="undefined",g.length<=0){eapp.view.Dialogs.showAlert("智慧潘家园","电话不能为空!~")}if(e==null||e=="undefined"||e.length<=0){eapp.view.Dialogs.showAlert("智慧潘家园","email不能为空!~")}if(i==null||i=="undefined"||i.lengthj<=0){eapp.view.Dialogs.showAlert("智慧潘家园","意见内容不能为空!~")}Ext.Viewport.setMasked({xtype:"loadmask",message:"请稍候..."});var b=Ext.create("eapp.business.IdeaService");b.addremark(d,g,a,e,i,{success:function(k){if(k=="OK"){var j=f.getMainview().getNavigationBar().getBackButton();j.fireEvent("tap",j,null,null);eapp.view.Dialogs.showAlert("智慧潘家园","提交意见成功!~")}else{eapp.view.Dialogs.showAlert("智慧潘家园","提交意见失败!~")}Ext.Viewport.setMasked(false)},failure:function(j){Ext.Viewport.setMasked(false);console.log(j)}})},});